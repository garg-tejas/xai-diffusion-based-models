# Model Configuration
model:
  checkpoint_path: "checkpoints/new/aptos-epoch94-accuracy-0.8410-f1-0.6983.ckpt"

  config_path: "configs/aptos.yml"

  diffusion_config_path: "option/diff_DDIM.yaml"

  device: "auto"

# Sample Selection
sampling:
  predictions_csv: "preds.csv"

  samples_per_class: 10

  # Options: 'balanced' (mix correct/incorrect), 'correct_only', 'incorrect_only', 'random'
  selection_strategy: "balanced"

  balanced_ratio: [7, 3]

  random_seed: 13

# Output Configuration
output:
  output_dir: "outputs"

  images_dir: "images"
  html_dir: "html"
  arrays_dir: "arrays"

  save_images: true
  save_html: false
  save_arrays: true

  create_interactive: true
  create_animations: false
  create_combined_animations: false
  animation_fps: 1
  animation_quality: "medium"
  show_animation_controls: true

  image_format: "png" # 'png' or 'jpg'
  image_dpi: 300
  save_pdf: true
  pdf_frame_layout: [2, 5] # Grid layout for animation frames in PDF (rows, cols)

# Visualization Settings
visualization:
  colormap: "jet"
  overlay_alpha: 0.5
  attention_resolution: [512, 512]
  normalize_attention: true
  figure_size: [12, 8]
  title_fontsize: 16
  label_fontsize: 12
  tick_fontsize: 10
  bbox_linewidth: 3
  bbox_colors: ["red", "blue", "green", "yellow", "cyan", "magenta"]

# Explainer Settings
explainers:
  attention:
    enabled: true
    class_specific: true
    show_patches: true
    show_weights: true

  # Diffusion Explainer settings
  diffusion:
    enabled: true
    # Set to -1 to visualize all timesteps, or a positive integer to subsample
    num_timesteps_to_visualize: -1
    create_animation: true
    animation_fps: 1
    show_simplex: false # 3D simplex only works well for 3-4 classes

  guidance_map:
    enabled: true
    create_animation: true

  feature_prior:
    enabled: true
    # Method for feature space visualization: 'pca' or 'tsne'
    # Note: Each visualization compares 1 raw feature + N ROI features (typically ~7 total per image)
    # PCA recommended for small feature sets (< 10 feature vectors) - more stable and interpretable
    # t-SNE better for larger feature sets (> 50 feature vectors) - captures non-linear relationships
    # With num_k=6 ROI patches, you have 7 total feature vectors â†’ PCA is recommended
    feature_space_method: "pca"

  noise_analysis:
    enabled: true
    create_animation: true

  # XAI-v2 Framework Modules
  faithfulness:
    enabled: true
    deletion_steps: 20
    occlusion_method: "blur" # "blur" or "mean"
    augmentation_count: 10

  conditional_attribution:
    enabled: true
    compute_gradients: true

  spatiotemporal:
    enabled: true
    track_timesteps: [1000, 900, 800, 700, 600, 500, 400, 300, 200, 100]

  counterfactual:
    enabled: true
    guidance_scale: 5.0
    target_transitions: [[4, 2], [3, 1], [2, 0]] # Generate counterfactuals for these transitions

# Data Processing
data:
  image_size: 512
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]

  num_classes: 5

  class_names:
    0: "No DR"
    1: "Mild"
    2: "Moderate"
    3: "Severe"
    4: "Proliferative DR"

# Logging
logging:
  # Verbosity level (0: minimal, 1: normal, 2: detailed)
  verbosity: 1

  show_progress: true

  save_log: true
  log_file: "outputs/xai_processing.log"

# Performance
performance:
  batch_size: 1

  num_workers: 0

  use_amp: false
